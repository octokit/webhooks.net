namespace Octokit.Webhooks.Models.RepositoryVulnerabilityAlertEvent;

using System;
using System.Text.Json.Serialization;
using JetBrains.Annotations;
using Octokit.Webhooks.Converter;

[PublicAPI]
public sealed record Alert
{
    [JsonPropertyName("id")]
    public long Id { get; init; }

    [JsonPropertyName("affected_range")]
    public string AffectedRange { get; init; } = null!;

    [JsonPropertyName("affected_package_name")]
    public string AffectedPackageName { get; init; } = null!;

    [JsonPropertyName("dismisser")]
    public User? Dismisser { get; init; }

    [JsonPropertyName("dismiss_reason")]
    public string? DismissReason { get; init; }

    [JsonPropertyName("dismissed_at")]
    [JsonConverter(typeof(NullableDateTimeOffsetConverter))]
    public DateTimeOffset? DismissedAt { get; init; }

    [JsonPropertyName("ghsa_id")]
    public string? GhsaId { get; init; }

    [JsonPropertyName("external_reference")]
    public string ExternalReference { get; init; } = null!;

    [JsonPropertyName("external_identifier")]
    public string ExternalIdentifier { get; init; } = null!;

    [JsonPropertyName("fixed_in")]
    public string FixedIn { get; init; } = null!;

    [JsonPropertyName("created_at")]
    [JsonConverter(typeof(NullableDateTimeOffsetConverter))]
    public DateTimeOffset? CreatedAt { get; init; }
}
